(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{377:function(t,_,v){"use strict";v.r(_);var e=v(42),a=Object(e.a)({},(function(){var t=this,_=t.$createElement,v=t._self._c||_;return v("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[v("h1",{attrs:{id:"network-service-instantiation"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#network-service-instantiation"}},[t._v("#")]),t._v(" Network Service Instantiation")]),t._v(" "),v("h2",{attrs:{id:"变量列表"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#变量列表"}},[t._v("#")]),t._v(" 变量列表")]),t._v(" "),v("h3",{attrs:{id:"instance-dict"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#instance-dict"}},[t._v("#")]),t._v(" instance_dict")]),t._v(" "),v("p",[t._v("开通请求传递的参数。")]),t._v(" "),v("h4",{attrs:{id:"instance-dict-networks"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#instance-dict-networks"}},[t._v("#")]),t._v(" instance_dict.networks")]),t._v(" "),v("p",[t._v("请求包含的network列表")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("变量名")]),t._v(" "),v("th",[t._v("描述")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("sites")]),t._v(" "),v("td",[t._v("network部署的站点。每个site指向一个vim("),v("code",[t._v("site.datacenter=dc.ID")]),t._v(")")])]),t._v(" "),v("tr",[v("td",[t._v("use-network")]),t._v(" "),v("td",[t._v("所使用的其他实例的网络")])]),t._v(" "),v("tr",[v("td",[t._v("vim-network-name")]),t._v(" "),v("td")]),t._v(" "),v("tr",[v("td",[t._v("vim-network-id")]),t._v(" "),v("td")]),t._v(" "),v("tr",[v("td",[t._v("name")]),t._v(" "),v("td")]),t._v(" "),v("tr",[v("td",[t._v("ip-profile")]),t._v(" "),v("td")]),t._v(" "),v("tr",[v("td",[t._v("provider-network")]),t._v(" "),v("td")])])]),t._v(" "),v("h4",{attrs:{id:"instance-dict-vnfs"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#instance-dict-vnfs"}},[t._v("#")]),t._v(" instance_dict.vnfs")]),t._v(" "),v("p",[t._v("请求包含的vnf列表")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("变量名")]),t._v(" "),v("th",[t._v("描述")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("datacenter")]),t._v(" "),v("td")])])]),t._v(" "),v("h3",{attrs:{id:"scenariodict"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#scenariodict"}},[t._v("#")]),t._v(" scenarioDict")]),t._v(" "),v("p",[t._v("开通使用的模版。从数据库读出来后， 在处理过程中，会将"),v("code",[t._v("instanceDict")]),t._v("中对应的参数拷贝到本对象中。")]),t._v(" "),v("h4",{attrs:{id:"scenanriodict-nets"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#scenanriodict-nets"}},[t._v("#")]),t._v(" scenanrioDict.nets")]),t._v(" "),v("p",[t._v("模版定义的network列表，每个network("),v("code",[t._v("sce_net")]),t._v(")包含：")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("变量名")]),t._v(" "),v("th",[t._v("描述")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("name")]),t._v(" "),v("td")]),t._v(" "),v("tr",[v("td",[t._v("wim_account")]),t._v(" "),v("td")]),t._v(" "),v("tr",[v("td",[t._v("ip_profile")]),t._v(" "),v("td")]),t._v(" "),v("tr",[v("td",[t._v("provider_network")]),t._v(" "),v("td")]),t._v(" "),v("tr",[v("td",[t._v("external")]),t._v(" "),v("td",[t._v("是否使用外部已有的网络")])]),t._v(" "),v("tr",[v("td",[t._v("vim_id")]),t._v(" "),v("td",[t._v("指定的已有网络在vim中的id")])])])]),t._v(" "),v("h4",{attrs:{id:"scenariodict-vnfs"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#scenariodict-vnfs"}},[t._v("#")]),t._v(" scenarioDict.vnfs")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("变量名")]),t._v(" "),v("th",[t._v("描述")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("interfaces")]),t._v(" "),v("td",[t._v("vnf内部用于连接其他vnf的网卡,其network指向sce_net")])])])]),t._v(" "),v("h3",{attrs:{id:"租户相关"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#租户相关"}},[t._v("#")]),t._v(" 租户相关")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("变量名")]),t._v(" "),v("th",[t._v("描述")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("tenant_id")]),t._v(" "),v("td",[t._v("用户传入的"),v("code",[t._v("tenant.ID")]),t._v("，即:"),v("code",[t._v("nfvoTenant.id")])])]),t._v(" "),v("tr",[v("td",[t._v("tenant")]),t._v(" "),v("td",[t._v("根据teant_id从"),v("code",[t._v("nfvo_tenants")]),t._v("查询到的tenant对象")])]),t._v(" "),v("tr",[v("td",[t._v("datacenter")]),t._v(" "),v("td",[t._v("用户传入的dc名称或者id")])]),t._v(" "),v("tr",[v("td",[t._v("default_wim_account")]),t._v(" "),v("td",[t._v("用户传入的wim账号")])]),t._v(" "),v("tr",[v("td",[t._v("default_datacenter_id")]),t._v(" "),v("td",[t._v("根据"),v("code",[t._v("datacenter")]),t._v("从"),v("code",[t._v("datacenters")]),t._v("查询得到到dc Id")])]),t._v(" "),v("tr",[v("td",[t._v("vim")]),t._v(" "),v("td",[t._v("根据"),v("code",[t._v("datacenter")]),t._v("从"),v("code",[t._v("datacenters")]),t._v("查询得到到dc对象")])]),t._v(" "),v("tr",[v("td",[t._v("myvims")]),t._v(" "),v("td",[t._v("dc.ID --\x3e dc")])]),t._v(" "),v("tr",[v("td",[t._v("myvim_threads_id")]),t._v(" "),v("td",[t._v("dc.ID --\x3e vimTenant.id")])])])]),t._v(" "),v("h3",{attrs:{id:"instance相关"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#instance相关"}},[t._v("#")]),t._v(" instance相关")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("变量名")]),t._v(" "),v("th",[t._v("描述")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("cloud_config")]),t._v(" "),v("td",[t._v("开通ns/vnf实例时使用的cloud_config对象")])]),t._v(" "),v("tr",[v("td",[t._v("db_instance_scenario")]),t._v(" "),v("td",[t._v("网络服务实例对象")])]),t._v(" "),v("tr",[v("td",[t._v("uuid_list")]),t._v(" "),v("td",[t._v("所有新建instance的uuid")])]),t._v(" "),v("tr",[v("td",[t._v("db_instarnce_nets")]),t._v(" "),v("td",[t._v("所有被创建的network")])]),t._v(" "),v("tr",[v("td",[t._v("db_ip_profiles")]),t._v(" "),v("td")])])]),t._v(" "),v("h3",{attrs:{id:"action-task相关"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#action-task相关"}},[t._v("#")]),t._v(" action/task相关")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("变量名")]),t._v(" "),v("th",[t._v("描述")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("rollbackList")]),t._v(" "),v("td",[t._v("????")])]),t._v(" "),v("tr",[v("td",[t._v("db_instance_action")]),t._v(" "),v("td",[t._v("action对象，通过"),v("code",[t._v("instance_id")]),t._v("关联到网络服务实例")])]),t._v(" "),v("tr",[v("td",[t._v("db_vim_actions")]),t._v(" "),v("td",[t._v("所有创建过程中新建的任务")])])])]),t._v(" "),v("h2",{attrs:{id:"过程"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#过程"}},[t._v("#")]),t._v(" 过程")]),t._v(" "),v("h3",{attrs:{id:"获取开通使用的缺省dc及tenant"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#获取开通使用的缺省dc及tenant"}},[t._v("#")]),t._v(" 获取开通使用的缺省DC及Tenant")]),t._v(" "),v("h3",{attrs:{id:"从数据库获取开通指定的descriptor-scenariodict"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#从数据库获取开通指定的descriptor-scenariodict"}},[t._v("#")]),t._v(" 从数据库获取开通指定的descriptor---"),v("code",[t._v("scenarioDict")])]),t._v(" "),v("p",[t._v("根据传入的"),v("code",[t._v("scenario")]),t._v("从数据库中获取到对应的数据："),v("code",[t._v("scenarioDict")]),t._v("。")]),t._v(" "),v("h3",{attrs:{id:"创建db-instance-scenario和db-instance-action对象"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#创建db-instance-scenario和db-instance-action对象"}},[t._v("#")]),t._v(" 创建"),v("code",[t._v("db_instance_scenario")]),t._v("和"),v("code",[t._v("db_instance_action")]),t._v("对象")]),t._v(" "),v("h3",{attrs:{id:"校验开通传入的网络参数"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#校验开通传入的网络参数"}},[t._v("#")]),t._v(" 校验开通传入的网络参数")]),t._v(" "),v("p",[t._v("校验开通需要的网络("),v("code",[t._v("instance_dict.networks")]),t._v(")是否在模版中有定义("),v("code",[t._v("scenarioDict.nets")]),t._v(")；\n然后把对应的参数复制到模版中；")]),t._v(" "),v("h3",{attrs:{id:"校验开通传入的vnf参数"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#校验开通传入的vnf参数"}},[t._v("#")]),t._v(" 校验开通传入的vnf参数")]),t._v(" "),v("p",[t._v("校验vnf需要的网络、vdu是否在模版中有对应描述；\n然后把对应的参数复制到模版中。")]),t._v(" "),v("h3",{attrs:{id:"在vim中创建sce-net"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#在vim中创建sce-net"}},[t._v("#")]),t._v(" 在vim中创建sce_net")]),t._v(" "),v("h4",{attrs:{id:"sce-net-变量"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#sce-net-变量"}},[t._v("#")]),t._v(" sce_net::变量")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("变量名")]),t._v(" "),v("th",[t._v("描述")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("number_mgmt_networks")]),t._v(" "),v("td",[t._v("网络服务的管理网络个数。如果"),v("code",[t._v("sce_net.external")]),t._v("不为空，则认为该网络是管理网络")])]),t._v(" "),v("tr",[v("td",[t._v("sce_net")]),t._v(" "),v("td",[t._v("网络模版："),v("code",[t._v("scenarioDict.nets")])])]),t._v(" "),v("tr",[v("td",[t._v("descriptor_net")]),t._v(" "),v("td",[t._v("网络开通请求："),v("code",[t._v("instance_dict.networks")])])]),t._v(" "),v("tr",[v("td",[t._v("use_network")]),t._v(" "),v("td",[v("code",[t._v("descriptor_net")]),t._v("依赖的已有网络实例")])]),t._v(" "),v("tr",[v("td",[t._v("involved_datacenters")]),t._v(" "),v("td",[t._v("网络依赖的vnf所在的DC列表")])]),t._v(" "),v("tr",[v("td",[t._v("target_wim_account")]),t._v(" "),v("td",[t._v("开通网络所要的wim账号")])]),t._v(" "),v("tr",[v("td",[t._v("sce_net2instance")]),t._v(" "),v("td",[t._v("sce_net.uuid --\x3e (dc.uuid --\x3e instance_net.uuid)")])]),t._v(" "),v("tr",[v("td",[t._v("sce_net2wiminstance")]),t._v(" "),v("td",[t._v("sce_net.uuid --\x3e (dc.uuid --\x3e )")])]),t._v(" "),v("tr",[v("td",[t._v("net2task_id")]),t._v(" "),v("td",[t._v("sce_net.uuid --\x3e")])]),t._v(" "),v("tr",[v("td",[t._v("wim_usage")]),t._v(" "),v("td",[t._v("sce_net.uuid --\x3e bool/wimAccount.uuid, 网络开通使用的wim")])]),t._v(" "),v("tr",[v("td",[t._v("wim_account")]),t._v(" "),v("td",[t._v("当前网络开通需要的wim")])]),t._v(" "),v("tr",[v("td",[t._v("netmap_use")]),t._v(" "),v("td",[v("code",[t._v("descriptor_net.site")]),t._v("的属性，如果设置，表示在该站点使用已有网络，属性的值指向已有网络的ID或者名称")])]),t._v(" "),v("tr",[v("td",[t._v("netmap_create "),v("code",[t._v("descriptor_net.site")]),t._v("的属性，如果设置，表示在该站点创建网络，属性的值表示网络的底层名称")]),t._v(" "),v("td")]),t._v(" "),v("tr",[v("td",[t._v("net_type")]),t._v(" "),v("td",[t._v("要创建的网络的类型")])]),t._v(" "),v("tr",[v("td",[t._v("net_vim_name")]),t._v(" "),v("td",[t._v("网络在vim中的名称")])]),t._v(" "),v("tr",[v("td",[t._v("lookfor_filter")]),t._v(" "),v("td",[t._v("用于查找已有网络的条件，包括："),v("code",[t._v("id")]),t._v(","),v("code",[t._v("name")]),t._v(","),v("code",[t._v("status")]),t._v("等")])]),t._v(" "),v("tr",[v("td",[t._v("net_name")]),t._v(" "),v("td",[t._v("要创建的网络的名称")])]),t._v(" "),v("tr",[v("td",[t._v("create_network")]),t._v(" "),v("td",[t._v("是否要创建新的网络")])]),t._v(" "),v("tr",[v("td",[t._v("lookfor_network")]),t._v(" "),v("td",[t._v("是否要查找已有网络")])]),t._v(" "),v("tr",[v("td",[t._v("task_extra")]),t._v(" "),v("td",[t._v("任务的额外信息，包括：params")])]),t._v(" "),v("tr",[v("td",[t._v("related_network")]),t._v(" "),v("td",[t._v("当前网络依赖另一个网络时，指向该网络的uuid；否则指向当前网络的uuid")])]),t._v(" "),v("tr",[v("td",[t._v("db_instance_wim_nets")]),t._v(" "),v("td")])])]),t._v(" "),v("h3",{attrs:{id:"在vim中创建vnf"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#在vim中创建vnf"}},[t._v("#")]),t._v(" 在vim中创建VNF")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("变量名")]),t._v(" "),v("th",[t._v("描述")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("sce_vnf")]),t._v(" "),v("td",[t._v("vnf开通对象，合并了对应vnf的模版和实例属性")])]),t._v(" "),v("tr",[v("td",[t._v("sce_vnf.mgmt_access")]),t._v(" "),v("td",[t._v("vnf模板中定义的管理访问方式")])]),t._v(" "),v("tr",[v("td",[t._v("RO_pub_key")]),t._v(" "),v("td",[v("code",[t._v("nfvoTenant")]),t._v("的属性，表示相应tenant的公钥，用于开通后osm对vnf的管理")])]),t._v(" "),v("tr",[v("td",[t._v("vim")]),t._v(" "),v("td",[t._v("dc")])]),t._v(" "),v("tr",[v("td",[t._v("datacenter_id")]),t._v(" "),v("td")]),t._v(" "),v("tr",[v("td",[t._v("myvim_thread_id")]),t._v(" "),v("td",[t._v("dc.Tenant.id")])])])]),t._v(" "),v("h4",{attrs:{id:"创建vnf内部网络"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#创建vnf内部网络"}},[t._v("#")]),t._v(" 创建vnf内部网络")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("变量名")]),t._v(" "),v("th",[t._v("描述")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("vnf_net2instance")]),t._v(" "),v("td",[v("code",[t._v("sce_vnf.uuid")]),t._v(" --\x3e "),v("code",[t._v("sce_vnf.net.uuid")]),t._v(" --\x3e "),v("code",[t._v("net.uuid")]),t._v("//")])]),t._v(" "),v("tr",[v("td",[t._v("vnf_net2wim_instance")]),t._v(" "),v("td")]),t._v(" "),v("tr",[v("td",[t._v("net2task_id")]),t._v(" "),v("td",[v("code",[t._v("sce_vnf.uuid")]),t._v(" --\x3e "),v("code",[t._v("sce_vnf.net.uuid")]),t._v(" -> "),v("code",[t._v("task_index")])])]),t._v(" "),v("tr",[v("td",[t._v("net")]),t._v(" "),v("td",[t._v("待开通的网络")])]),t._v(" "),v("tr",[v("td",[t._v("net_name")]),t._v(" "),v("td")]),t._v(" "),v("tr",[v("td",[t._v("net_type")]),t._v(" "),v("td")]),t._v(" "),v("tr",[v("td",[t._v("lookfor_filter")]),t._v(" "),v("td",[t._v("查找已有网络的条件")])]),t._v(" "),v("tr",[v("td",[t._v("task_action")]),t._v(" "),v("td",[v("code",[t._v("find")]),t._v("(如果"),v("code",[t._v("net")]),t._v("中指定了要使用的网络，比如："),v("code",[t._v("vim_network_name")]),t._v(") or "),v("code",[t._v("create")]),t._v("（如果没有指定网络）")])]),t._v(" "),v("tr",[v("td",[t._v("task_extra")]),t._v(" "),v("td",[v("code",[t._v("lookfor_filter")]),t._v("(如果"),v("code",[t._v("task_action=find")]),t._v(")或者"),v("code",[t._v("net_name + net_type + net.ip_profile")]),t._v("(如果"),v("code",[t._v("task_action=create")]),t._v(")")])])])]),t._v(" "),v("h4",{attrs:{id:"创建虚拟机"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#创建虚拟机"}},[t._v("#")]),t._v(" 创建虚拟机")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("变量名")]),t._v(" "),v("th",[t._v("描述")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("ssh_access")]),t._v(" "),v("td",[v("code",[t._v("sce_vnf['mgmt_access'].get('config-access', {}).get('ssh-access')")])])]),t._v(" "),v("tr",[v("td",[t._v("vnf_availability_zones")]),t._v(" "),v("td")]),t._v(" "),v("tr",[v("td",[t._v("vm")]),t._v(" "),v("td",[t._v("初始设置为vm模版(sce_vnf.vms)，创建过程中会添加一些辅助属性")])]),t._v(" "),v("tr",[v("td",[t._v("myVMDict")]),t._v(" "),v("td",[t._v("传递到vim的虚拟机创建参数")])]),t._v(" "),v("tr",[v("td",[t._v("image_dict")]),t._v(" "),v("td",[t._v("从数据库("),v("code",[t._v("images")]),t._v(")根据"),v("code",[t._v("vm.image_id")]),t._v("得到的image对象(说明image已经存在于系统中)")])]),t._v(" "),v("tr",[v("td",[t._v("image_id")]),t._v(" "),v("td",[t._v("image在vim对应的id")])]),t._v(" "),v("tr",[v("td",[t._v("flavor_dict")]),t._v(" "),v("td",[t._v("从数据库("),v("code",[t._v("flavors")]),t._v(")根据"),v("code",[t._v("vm.flavlor_id")]),t._v("得到的flavor对象")])]),t._v(" "),v("tr",[v("td",[t._v("myVMDict.networks")]),t._v(" "),v("td",[t._v("虚拟机的网卡参数")])]),t._v(" "),v("tr",[v("td",[t._v("myVMDict.imageRef")]),t._v(" "),v("td")]),t._v(" "),v("tr",[v("td",[t._v("myVMDict.flavorRef")]),t._v(" "),v("td")]),t._v(" "),v("tr",[v("td",[t._v("is_management_vm")]),t._v(" "),v("td",[t._v("当前vm是否为vnf的管理节点")])]),t._v(" "),v("tr",[v("td",[t._v("cloud_config_vm")]),t._v(" "),v("td")]),t._v(" "),v("tr",[v("td",[t._v("av_index")]),t._v(" "),v("td")])])]),t._v(" "),v("h5",{attrs:{id:"创建-使用镜像"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#创建-使用镜像"}},[t._v("#")]),t._v(" 创建/使用镜像")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("变量名")]),t._v(" "),v("th",[t._v("描述")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("image_mano_id")]),t._v(" "),v("td")]),t._v(" "),v("tr",[v("td",[t._v("datacenter_vim_id")]),t._v(" "),v("td",[t._v("dc.tenantId")])]),t._v(" "),v("tr",[v("td",[t._v("image_db")]),t._v(" "),v("td",[v("code",[t._v("datacenter_images")]),t._v("中的记录，是ro的image记录在dc中对应的对象")])]),t._v(" "),v("tr",[v("td",[t._v("image_vim_id")]),t._v(" "),v("td")])])]),t._v(" "),v("ol",[v("li",[t._v("根据"),v("code",[t._v("image_dict.location")]),t._v("或者"),v("code",[t._v("image_dict.universal_name")]),t._v("去vim查找对应的image；")]),t._v(" "),v("li",[t._v("如果没有查到，则根据"),v("code",[t._v("image_dict")]),t._v("在vim创建一个image，成功后，在"),v("code",[t._v("datacenter_images")]),t._v("中创建一条对应记录；")]),t._v(" "),v("li",[t._v("返回查找到/或新创建的image的vim_id")])]),t._v(" "),v("h5",{attrs:{id:"创建-使用flavor"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#创建-使用flavor"}},[t._v("#")]),t._v(" 创建/使用flavor")]),t._v(" "),v("ol",[v("li",[t._v("根据"),v("code",[t._v("flavor_dict.uuid")]),t._v("查找"),v("code",[t._v("datacenters_flavors")]),t._v("中对应的记录："),v("code",[t._v("flavor_db")]),t._v(";")]),t._v(" "),v("li",[t._v("如果"),v("code",[t._v("flavlor_db")]),t._v("存在并且能够根据"),v("code",[t._v("flavor_db.vim_id")]),t._v("在vim中找到对应的flavor，则返回；")]),t._v(" "),v("li",[t._v("否则，首先查找"),v("code",[t._v("flavor_dict")]),t._v("在vim的对应记录，如果没有，则在vim中创建一个对应记录；")]),t._v(" "),v("li",[t._v("查找成功或者创建成功，则修改"),v("code",[t._v("datacenter_flvor")]),t._v("的vim_id或者创建一条新的对应记录；")]),t._v(" "),v("li",[t._v("返回查找到/或新创建的flavor的vim_id")])]),t._v(" "),v("h5",{attrs:{id:"创建通用网卡对象"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#创建通用网卡对象"}},[t._v("#")]),t._v(" 创建通用网卡对象")]),t._v(" "),v("p",[t._v("一个vm可能对应若干个具体的虚拟机，在创建具体的虚拟机前，我们可以网卡模版的属性，创建通用网卡对象。\n只有在创建虚拟机时，每个通用网卡对象都会被实例化成一个具体的网卡。")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("变量名")]),t._v(" "),v("th",[t._v("描述")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("iface")]),t._v(" "),v("td",[t._v("待创建的网卡的模版. "),v("code",[t._v("vm.interfaces")])])]),t._v(" "),v("tr",[v("td",[t._v("netDict")]),t._v(" "),v("td",[t._v("待创建的网卡")])]),t._v(" "),v("tr",[v("td",[t._v("netDict.type")]),t._v(" "),v("td",[t._v("PF(passthrough), VF(siov), VFNotShared(), Virtual")])]),t._v(" "),v("tr",[v("td",[t._v("netDict.use")]),t._v(" "),v("td",[t._v("用途 (data/mgmt)")])]),t._v(" "),v("tr",[v("td",[t._v("netDict.mac_address/floating_ip/port_security")]),t._v(" "),v("td")]),t._v(" "),v("tr",[v("td",[t._v("netDict.net_id")]),t._v(" "),v("td",[t._v("仅仅是个标识，等于该网卡关联网络的对应任务")])])])]),t._v(" "),v("p",[t._v("对vdu定义的每一块网卡：")]),t._v(" "),v("ol",[v("li",[t._v("设置属性；")]),t._v(" "),v("li",[t._v("根据网卡关联网络，找到该网络对应的任务，把该任务作为创建虚拟机依赖的任务；")]),t._v(" "),v("li",[t._v("创建对应记录添加到"),v("code",[t._v("db_vm_ifaces")])])]),t._v(" "),v("h5",{attrs:{id:"设置clooud-config"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#设置clooud-config"}},[t._v("#")]),t._v(" 设置clooud-config")]),t._v(" "),v("h5",{attrs:{id:"创建vm"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#创建vm"}},[t._v("#")]),t._v(" 创建vm")]),t._v(" "),v("p",[t._v("根据"),v("code",[t._v("vm.count")]),t._v("，创建对应数量的虚拟机实例。")]),t._v(" "),v("ol",[v("li",[t._v("确定对应的任务的参数("),v("code",[t._v("task_params")]),t._v(")：")])]),t._v(" "),v("div",{staticClass:"language-python extra-class"},[v("pre",{pre:!0,attrs:{class:"language-python"}},[v("code",[t._v("task_params "),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm_name"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" myVMDict"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),v("span",{pre:!0,attrs:{class:"token string"}},[t._v("'description'")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" myVMDict"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),v("span",{pre:!0,attrs:{class:"token string"}},[t._v("'start'")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                           myVMDict"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),v("span",{pre:!0,attrs:{class:"token string"}},[t._v("'imageRef'")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" myVMDict"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),v("span",{pre:!0,attrs:{class:"token string"}},[t._v("'flavorRef'")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" myVMDict"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),v("span",{pre:!0,attrs:{class:"token string"}},[t._v("'networks'")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cloud_config_vm"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                           myVMDict"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),v("span",{pre:!0,attrs:{class:"token string"}},[t._v("'disks'")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" av_index"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnf_availability_zones"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),v("ol",{attrs:{start:"2"}},[v("li",[v("p",[t._v("根据"),v("code",[t._v("db_vm_ifaces")]),t._v("创建该虚拟机的网卡，网卡会被添加到"),v("code",[t._v("db_instance_interfaces")])])]),t._v(" "),v("li",[v("p",[t._v("创建对应的任务")])])]),t._v(" "),v("h2",{attrs:{id:"参考"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),v("h3",{attrs:{id:"osm-usage"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#osm-usage"}},[t._v("#")]),t._v(" OSM Usage")]),t._v(" "),v("p",[t._v("这个"),v("a",{attrs:{href:"https://osm.etsi.org/docs/user-guide/05-osm-usage.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("页面"),v("OutboundLink")],1),t._v("介绍了创建/管理网络服务的一些场景，可以帮助我们理解"),v("code",[t._v("cloud-config")]),t._v("，"),v("code",[t._v("instantiation-parameter")]),t._v("的实际使用。")]),t._v(" "),v("h3",{attrs:{id:"vnf-onboarding-guide-day-0"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#vnf-onboarding-guide-day-0"}},[t._v("#")]),t._v(" VNF Onboarding guide (day-0)")]),t._v(" "),v("p",[v("a",{attrs:{href:"https://osm.etsi.org/docs/vnf-onboarding-guidelines/02-day0.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("VNF OnBoarding Day-0"),v("OutboundLink")],1),t._v("介绍了如何创建/修改/测试vnfd package")]),t._v(" "),v("p",[t._v("Remember the objectives of this phase(day-0):")]),t._v(" "),v("blockquote",[v("ul",[v("li",[v("p",[t._v("Instantiating the VNF with all the required VDUs, images, initial (unconfigured) state and NFVI requirements.")])]),t._v(" "),v("li",[v("p",[t._v("Making the VNF manageable from OSM (OSM should have SSH access to the management interfaces, for example)")])])])]),t._v(" "),v("h3",{attrs:{id:"vnf-onboarding-guide-day-1"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#vnf-onboarding-guide-day-1"}},[t._v("#")]),t._v(" VNF Onboarding guide (day-1)")]),t._v(" "),v("p",[v("a",{attrs:{href:"https://osm.etsi.org/docs/vnf-onboarding-guidelines/03-day1.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("VNF OnBoarding Day-1"),v("OutboundLink")],1),t._v("介绍了如何修改vnfd，使得vnf可以在被创建后被自动初始化。")]),t._v(" "),v("p",[t._v("OSM中实现这个目标的方式是构建osm proxy charm，然后把它包含在descriptor中。")]),t._v(" "),v("h3",{attrs:{id:"cloud-init"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#cloud-init"}},[t._v("#")]),t._v(" Cloud-init")]),t._v(" "),v("p",[t._v("Cloud-init是一个工业标准，它使用一种通用的方式描述配置，https://cloudinit.readthedocs.io/en/latest/。\n通过cloud-init，我们可以在day-0完成vnf的初始化。")]),t._v(" "),v("blockquote",[v("p",[t._v("Cloud-init is normally used for Day-0 operations like:")]),t._v(" "),v("ul",[v("li",[t._v("Setting a default locale")]),t._v(" "),v("li",[t._v("Setting an instance hostname")]),t._v(" "),v("li",[t._v("Generating instance SSH private keys or defining passwords")]),t._v(" "),v("li",[t._v("Adding SSH keys to a user’s .ssh/authorized_keys so they can log in")]),t._v(" "),v("li",[t._v("Setting up ephemeral mount points")]),t._v(" "),v("li",[t._v("Configuring network devices")]),t._v(" "),v("li",[t._v("Adding users and groups")]),t._v(" "),v("li",[t._v("Adding files")])])])])}),[],!1,null,null,null);_.default=a.exports}}]);