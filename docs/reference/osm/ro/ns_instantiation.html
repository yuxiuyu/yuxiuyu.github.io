<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Network Service Instantiation</title>
    <meta name="generator" content="VuePress 1.5.3">
    
    <meta name="description" content="">
    <link rel="preload" href="/assets/css/0.styles.29a2c3e4.css" as="style"><link rel="preload" href="/assets/js/app.131032e6.js" as="script"><link rel="preload" href="/assets/js/2.f5d61f7a.js" as="script"><link rel="preload" href="/assets/js/23.120810af.js" as="script"><link rel="prefetch" href="/assets/js/10.268a6dc6.js"><link rel="prefetch" href="/assets/js/11.4c0a7bab.js"><link rel="prefetch" href="/assets/js/12.19d2a09e.js"><link rel="prefetch" href="/assets/js/13.f29b8039.js"><link rel="prefetch" href="/assets/js/14.c835afd8.js"><link rel="prefetch" href="/assets/js/15.a6fef53e.js"><link rel="prefetch" href="/assets/js/16.5b23cf45.js"><link rel="prefetch" href="/assets/js/17.f4ba404d.js"><link rel="prefetch" href="/assets/js/18.b0515cd3.js"><link rel="prefetch" href="/assets/js/19.4381408a.js"><link rel="prefetch" href="/assets/js/20.6a06c534.js"><link rel="prefetch" href="/assets/js/21.1081aac1.js"><link rel="prefetch" href="/assets/js/22.ee46aed0.js"><link rel="prefetch" href="/assets/js/24.8ec3230d.js"><link rel="prefetch" href="/assets/js/25.9320bb42.js"><link rel="prefetch" href="/assets/js/26.977132c8.js"><link rel="prefetch" href="/assets/js/3.597a5b31.js"><link rel="prefetch" href="/assets/js/4.21fd4293.js"><link rel="prefetch" href="/assets/js/5.139dcb5b.js"><link rel="prefetch" href="/assets/js/6.b6cf2c13.js"><link rel="prefetch" href="/assets/js/7.c0fd1940.js"><link rel="prefetch" href="/assets/js/8.6a61df00.js"><link rel="prefetch" href="/assets/js/9.b32a6e74.js">
    <link rel="stylesheet" href="/assets/css/0.styles.29a2c3e4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/reference/" class="nav-link router-link-active">
  Reference
</a></div><div class="nav-item"><a href="https://osm.etsi.org/docs/user-guide" target="_blank" rel="noopener noreferrer" class="nav-link external">
  OSM
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/reference/" class="nav-link router-link-active">
  Reference
</a></div><div class="nav-item"><a href="https://osm.etsi.org/docs/user-guide" target="_blank" rel="noopener noreferrer" class="nav-link external">
  OSM
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/" class="sidebar-heading clickable router-link-active open"><span>文档</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/reference/" aria-current="page" class="sidebar-link">介绍</a></li><li><a href="/reference/cloud/" class="sidebar-link">CLOUD简介</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/reference/osm/" class="sidebar-heading clickable router-link-active open"><span>OSM简介</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/reference/osm/model/" class="sidebar-heading clickable"><span>OSM模型解读</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/reference/osm/ro/" class="sidebar-heading clickable router-link-active open"><span>RO模块</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/reference/osm/ro/new-nsd.html" class="sidebar-link">导入nsd</a></li><li><a href="/reference/osm/ro/new-vnfd.html" class="sidebar-link">导入vnfd</a></li><li><a href="/reference/osm/ro/ns_mano_client.html" class="sidebar-link">Client简单说明</a></li><li><a href="/reference/osm/ro/ns_new_instance.html" class="sidebar-link">从零创建一个实例过程说明</a></li><li><a href="/reference/osm/ro/ns_instantiation.html" aria-current="page" class="active sidebar-link">服务实例化过程变量说明</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reference/osm/ro/ns_instantiation.html#变量列表" class="sidebar-link">变量列表</a></li><li class="sidebar-sub-header"><a href="/reference/osm/ro/ns_instantiation.html#过程" class="sidebar-link">过程</a></li><li class="sidebar-sub-header"><a href="/reference/osm/ro/ns_instantiation.html#参考" class="sidebar-link">参考</a></li></ul></li><li><a href="/reference/osm/ro/vim_interaction.html" class="sidebar-link">同VIM的交互</a></li></ul></section></li><li><a href="/reference/osm/reference.html" class="sidebar-link">OSM参考文献</a></li></ul></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="network-service-instantiation"><a href="#network-service-instantiation" class="header-anchor">#</a> Network Service Instantiation</h1> <h2 id="变量列表"><a href="#变量列表" class="header-anchor">#</a> 变量列表</h2> <h3 id="instance-dict"><a href="#instance-dict" class="header-anchor">#</a> instance_dict</h3> <p>开通请求传递的参数。</p> <h4 id="instance-dict-networks"><a href="#instance-dict-networks" class="header-anchor">#</a> instance_dict.networks</h4> <p>请求包含的network列表</p> <table><thead><tr><th>变量名</th> <th>描述</th></tr></thead> <tbody><tr><td>sites</td> <td>network部署的站点。每个site指向一个vim(<code>site.datacenter=dc.ID</code>)</td></tr> <tr><td>use-network</td> <td>所使用的其他实例的网络</td></tr> <tr><td>vim-network-name</td> <td></td></tr> <tr><td>vim-network-id</td> <td></td></tr> <tr><td>name</td> <td></td></tr> <tr><td>ip-profile</td> <td></td></tr> <tr><td>provider-network</td> <td></td></tr></tbody></table> <h4 id="instance-dict-vnfs"><a href="#instance-dict-vnfs" class="header-anchor">#</a> instance_dict.vnfs</h4> <p>请求包含的vnf列表</p> <table><thead><tr><th>变量名</th> <th>描述</th></tr></thead> <tbody><tr><td>datacenter</td> <td></td></tr></tbody></table> <h3 id="scenariodict"><a href="#scenariodict" class="header-anchor">#</a> scenarioDict</h3> <p>开通使用的模版。从数据库读出来后， 在处理过程中，会将<code>instanceDict</code>中对应的参数拷贝到本对象中。</p> <h4 id="scenanriodict-nets"><a href="#scenanriodict-nets" class="header-anchor">#</a> scenanrioDict.nets</h4> <p>模版定义的network列表，每个network(<code>sce_net</code>)包含：</p> <table><thead><tr><th>变量名</th> <th>描述</th></tr></thead> <tbody><tr><td>name</td> <td></td></tr> <tr><td>wim_account</td> <td></td></tr> <tr><td>ip_profile</td> <td></td></tr> <tr><td>provider_network</td> <td></td></tr> <tr><td>external</td> <td>是否使用外部已有的网络</td></tr> <tr><td>vim_id</td> <td>指定的已有网络在vim中的id</td></tr></tbody></table> <h4 id="scenariodict-vnfs"><a href="#scenariodict-vnfs" class="header-anchor">#</a> scenarioDict.vnfs</h4> <table><thead><tr><th>变量名</th> <th>描述</th></tr></thead> <tbody><tr><td>interfaces</td> <td>vnf内部用于连接其他vnf的网卡,其network指向sce_net</td></tr></tbody></table> <h3 id="租户相关"><a href="#租户相关" class="header-anchor">#</a> 租户相关</h3> <table><thead><tr><th>变量名</th> <th>描述</th></tr></thead> <tbody><tr><td>tenant_id</td> <td>用户传入的<code>tenant.ID</code>，即:<code>nfvoTenant.id</code></td></tr> <tr><td>tenant</td> <td>根据teant_id从<code>nfvo_tenants</code>查询到的tenant对象</td></tr> <tr><td>datacenter</td> <td>用户传入的dc名称或者id</td></tr> <tr><td>default_wim_account</td> <td>用户传入的wim账号</td></tr> <tr><td>default_datacenter_id</td> <td>根据<code>datacenter</code>从<code>datacenters</code>查询得到到dc Id</td></tr> <tr><td>vim</td> <td>根据<code>datacenter</code>从<code>datacenters</code>查询得到到dc对象</td></tr> <tr><td>myvims</td> <td>dc.ID --&gt; dc</td></tr> <tr><td>myvim_threads_id</td> <td>dc.ID --&gt; vimTenant.id</td></tr></tbody></table> <h3 id="instance相关"><a href="#instance相关" class="header-anchor">#</a> instance相关</h3> <table><thead><tr><th>变量名</th> <th>描述</th></tr></thead> <tbody><tr><td>cloud_config</td> <td>开通ns/vnf实例时使用的cloud_config对象</td></tr> <tr><td>db_instance_scenario</td> <td>网络服务实例对象</td></tr> <tr><td>uuid_list</td> <td>所有新建instance的uuid</td></tr> <tr><td>db_instarnce_nets</td> <td>所有被创建的network</td></tr> <tr><td>db_ip_profiles</td> <td></td></tr></tbody></table> <h3 id="action-task相关"><a href="#action-task相关" class="header-anchor">#</a> action/task相关</h3> <table><thead><tr><th>变量名</th> <th>描述</th></tr></thead> <tbody><tr><td>rollbackList</td> <td>????</td></tr> <tr><td>db_instance_action</td> <td>action对象，通过<code>instance_id</code>关联到网络服务实例</td></tr> <tr><td>db_vim_actions</td> <td>所有创建过程中新建的任务</td></tr></tbody></table> <h2 id="过程"><a href="#过程" class="header-anchor">#</a> 过程</h2> <h3 id="获取开通使用的缺省dc及tenant"><a href="#获取开通使用的缺省dc及tenant" class="header-anchor">#</a> 获取开通使用的缺省DC及Tenant</h3> <h3 id="从数据库获取开通指定的descriptor-scenariodict"><a href="#从数据库获取开通指定的descriptor-scenariodict" class="header-anchor">#</a> 从数据库获取开通指定的descriptor---<code>scenarioDict</code></h3> <p>根据传入的<code>scenario</code>从数据库中获取到对应的数据：<code>scenarioDict</code>。</p> <h3 id="创建db-instance-scenario和db-instance-action对象"><a href="#创建db-instance-scenario和db-instance-action对象" class="header-anchor">#</a> 创建<code>db_instance_scenario</code>和<code>db_instance_action</code>对象</h3> <h3 id="校验开通传入的网络参数"><a href="#校验开通传入的网络参数" class="header-anchor">#</a> 校验开通传入的网络参数</h3> <p>校验开通需要的网络(<code>instance_dict.networks</code>)是否在模版中有定义(<code>scenarioDict.nets</code>)；
然后把对应的参数复制到模版中；</p> <h3 id="校验开通传入的vnf参数"><a href="#校验开通传入的vnf参数" class="header-anchor">#</a> 校验开通传入的vnf参数</h3> <p>校验vnf需要的网络、vdu是否在模版中有对应描述；
然后把对应的参数复制到模版中。</p> <h3 id="在vim中创建sce-net"><a href="#在vim中创建sce-net" class="header-anchor">#</a> 在vim中创建sce_net</h3> <h4 id="sce-net-变量"><a href="#sce-net-变量" class="header-anchor">#</a> sce_net::变量</h4> <table><thead><tr><th>变量名</th> <th>描述</th></tr></thead> <tbody><tr><td>number_mgmt_networks</td> <td>网络服务的管理网络个数。如果<code>sce_net.external</code>不为空，则认为该网络是管理网络</td></tr> <tr><td>sce_net</td> <td>网络模版：<code>scenarioDict.nets</code></td></tr> <tr><td>descriptor_net</td> <td>网络开通请求：<code>instance_dict.networks</code></td></tr> <tr><td>use_network</td> <td><code>descriptor_net</code>依赖的已有网络实例</td></tr> <tr><td>involved_datacenters</td> <td>网络依赖的vnf所在的DC列表</td></tr> <tr><td>target_wim_account</td> <td>开通网络所要的wim账号</td></tr> <tr><td>sce_net2instance</td> <td>sce_net.uuid --&gt; (dc.uuid --&gt; instance_net.uuid)</td></tr> <tr><td>sce_net2wiminstance</td> <td>sce_net.uuid --&gt; (dc.uuid --&gt; )</td></tr> <tr><td>net2task_id</td> <td>sce_net.uuid --&gt;</td></tr> <tr><td>wim_usage</td> <td>sce_net.uuid --&gt; bool/wimAccount.uuid, 网络开通使用的wim</td></tr> <tr><td>wim_account</td> <td>当前网络开通需要的wim</td></tr> <tr><td>netmap_use</td> <td><code>descriptor_net.site</code>的属性，如果设置，表示在该站点使用已有网络，属性的值指向已有网络的ID或者名称</td></tr> <tr><td>netmap_create <code>descriptor_net.site</code>的属性，如果设置，表示在该站点创建网络，属性的值表示网络的底层名称</td> <td></td></tr> <tr><td>net_type</td> <td>要创建的网络的类型</td></tr> <tr><td>net_vim_name</td> <td>网络在vim中的名称</td></tr> <tr><td>lookfor_filter</td> <td>用于查找已有网络的条件，包括：<code>id</code>,<code>name</code>,<code>status</code>等</td></tr> <tr><td>net_name</td> <td>要创建的网络的名称</td></tr> <tr><td>create_network</td> <td>是否要创建新的网络</td></tr> <tr><td>lookfor_network</td> <td>是否要查找已有网络</td></tr> <tr><td>task_extra</td> <td>任务的额外信息，包括：params</td></tr> <tr><td>related_network</td> <td>当前网络依赖另一个网络时，指向该网络的uuid；否则指向当前网络的uuid</td></tr> <tr><td>db_instance_wim_nets</td> <td></td></tr></tbody></table> <h3 id="在vim中创建vnf"><a href="#在vim中创建vnf" class="header-anchor">#</a> 在vim中创建VNF</h3> <table><thead><tr><th>变量名</th> <th>描述</th></tr></thead> <tbody><tr><td>sce_vnf</td> <td>vnf开通对象，合并了对应vnf的模版和实例属性</td></tr> <tr><td>sce_vnf.mgmt_access</td> <td>vnf模板中定义的管理访问方式</td></tr> <tr><td>RO_pub_key</td> <td><code>nfvoTenant</code>的属性，表示相应tenant的公钥，用于开通后osm对vnf的管理</td></tr> <tr><td>vim</td> <td>dc</td></tr> <tr><td>datacenter_id</td> <td></td></tr> <tr><td>myvim_thread_id</td> <td>dc.Tenant.id</td></tr></tbody></table> <h4 id="创建vnf内部网络"><a href="#创建vnf内部网络" class="header-anchor">#</a> 创建vnf内部网络</h4> <table><thead><tr><th>变量名</th> <th>描述</th></tr></thead> <tbody><tr><td>vnf_net2instance</td> <td><code>sce_vnf.uuid</code> --&gt; <code>sce_vnf.net.uuid</code> --&gt; <code>net.uuid</code>//</td></tr> <tr><td>vnf_net2wim_instance</td> <td></td></tr> <tr><td>net2task_id</td> <td><code>sce_vnf.uuid</code> --&gt; <code>sce_vnf.net.uuid</code> -&gt; <code>task_index</code></td></tr> <tr><td>net</td> <td>待开通的网络</td></tr> <tr><td>net_name</td> <td></td></tr> <tr><td>net_type</td> <td></td></tr> <tr><td>lookfor_filter</td> <td>查找已有网络的条件</td></tr> <tr><td>task_action</td> <td><code>find</code>(如果<code>net</code>中指定了要使用的网络，比如：<code>vim_network_name</code>) or <code>create</code>（如果没有指定网络）</td></tr> <tr><td>task_extra</td> <td><code>lookfor_filter</code>(如果<code>task_action=find</code>)或者<code>net_name + net_type + net.ip_profile</code>(如果<code>task_action=create</code>)</td></tr></tbody></table> <h4 id="创建虚拟机"><a href="#创建虚拟机" class="header-anchor">#</a> 创建虚拟机</h4> <table><thead><tr><th>变量名</th> <th>描述</th></tr></thead> <tbody><tr><td>ssh_access</td> <td><code>sce_vnf['mgmt_access'].get('config-access', {}).get('ssh-access')</code></td></tr> <tr><td>vnf_availability_zones</td> <td></td></tr> <tr><td>vm</td> <td>初始设置为vm模版(sce_vnf.vms)，创建过程中会添加一些辅助属性</td></tr> <tr><td>myVMDict</td> <td>传递到vim的虚拟机创建参数</td></tr> <tr><td>image_dict</td> <td>从数据库(<code>images</code>)根据<code>vm.image_id</code>得到的image对象(说明image已经存在于系统中)</td></tr> <tr><td>image_id</td> <td>image在vim对应的id</td></tr> <tr><td>flavor_dict</td> <td>从数据库(<code>flavors</code>)根据<code>vm.flavlor_id</code>得到的flavor对象</td></tr> <tr><td>myVMDict.networks</td> <td>虚拟机的网卡参数</td></tr> <tr><td>myVMDict.imageRef</td> <td></td></tr> <tr><td>myVMDict.flavorRef</td> <td></td></tr> <tr><td>is_management_vm</td> <td>当前vm是否为vnf的管理节点</td></tr> <tr><td>cloud_config_vm</td> <td></td></tr> <tr><td>av_index</td> <td></td></tr></tbody></table> <h5 id="创建-使用镜像"><a href="#创建-使用镜像" class="header-anchor">#</a> 创建/使用镜像</h5> <table><thead><tr><th>变量名</th> <th>描述</th></tr></thead> <tbody><tr><td>image_mano_id</td> <td></td></tr> <tr><td>datacenter_vim_id</td> <td>dc.tenantId</td></tr> <tr><td>image_db</td> <td><code>datacenter_images</code>中的记录，是ro的image记录在dc中对应的对象</td></tr> <tr><td>image_vim_id</td> <td></td></tr></tbody></table> <ol><li>根据<code>image_dict.location</code>或者<code>image_dict.universal_name</code>去vim查找对应的image；</li> <li>如果没有查到，则根据<code>image_dict</code>在vim创建一个image，成功后，在<code>datacenter_images</code>中创建一条对应记录；</li> <li>返回查找到/或新创建的image的vim_id</li></ol> <h5 id="创建-使用flavor"><a href="#创建-使用flavor" class="header-anchor">#</a> 创建/使用flavor</h5> <ol><li>根据<code>flavor_dict.uuid</code>查找<code>datacenters_flavors</code>中对应的记录：<code>flavor_db</code>;</li> <li>如果<code>flavlor_db</code>存在并且能够根据<code>flavor_db.vim_id</code>在vim中找到对应的flavor，则返回；</li> <li>否则，首先查找<code>flavor_dict</code>在vim的对应记录，如果没有，则在vim中创建一个对应记录；</li> <li>查找成功或者创建成功，则修改<code>datacenter_flvor</code>的vim_id或者创建一条新的对应记录；</li> <li>返回查找到/或新创建的flavor的vim_id</li></ol> <h5 id="创建通用网卡对象"><a href="#创建通用网卡对象" class="header-anchor">#</a> 创建通用网卡对象</h5> <p>一个vm可能对应若干个具体的虚拟机，在创建具体的虚拟机前，我们可以网卡模版的属性，创建通用网卡对象。
只有在创建虚拟机时，每个通用网卡对象都会被实例化成一个具体的网卡。</p> <table><thead><tr><th>变量名</th> <th>描述</th></tr></thead> <tbody><tr><td>iface</td> <td>待创建的网卡的模版. <code>vm.interfaces</code></td></tr> <tr><td>netDict</td> <td>待创建的网卡</td></tr> <tr><td>netDict.type</td> <td>PF(passthrough), VF(siov), VFNotShared(), Virtual</td></tr> <tr><td>netDict.use</td> <td>用途 (data/mgmt)</td></tr> <tr><td>netDict.mac_address/floating_ip/port_security</td> <td></td></tr> <tr><td>netDict.net_id</td> <td>仅仅是个标识，等于该网卡关联网络的对应任务</td></tr></tbody></table> <p>对vdu定义的每一块网卡：</p> <ol><li>设置属性；</li> <li>根据网卡关联网络，找到该网络对应的任务，把该任务作为创建虚拟机依赖的任务；</li> <li>创建对应记录添加到<code>db_vm_ifaces</code></li></ol> <h5 id="设置clooud-config"><a href="#设置clooud-config" class="header-anchor">#</a> 设置clooud-config</h5> <h5 id="创建vm"><a href="#创建vm" class="header-anchor">#</a> 创建vm</h5> <p>根据<code>vm.count</code>，创建对应数量的虚拟机实例。</p> <ol><li>确定对应的任务的参数(<code>task_params</code>)：</li></ol> <div class="language-python extra-class"><pre class="language-python"><code>task_params <span class="token operator">=</span> <span class="token punctuation">(</span>vm_name<span class="token punctuation">,</span> myVMDict<span class="token punctuation">[</span><span class="token string">'description'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> myVMDict<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'start'</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                           myVMDict<span class="token punctuation">[</span><span class="token string">'imageRef'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> myVMDict<span class="token punctuation">[</span><span class="token string">'flavorRef'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> myVMDict<span class="token punctuation">[</span><span class="token string">'networks'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cloud_config_vm<span class="token punctuation">,</span>
                           myVMDict<span class="token punctuation">[</span><span class="token string">'disks'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> av_index<span class="token punctuation">,</span> vnf_availability_zones<span class="token punctuation">)</span>
</code></pre></div><ol start="2"><li><p>根据<code>db_vm_ifaces</code>创建该虚拟机的网卡，网卡会被添加到<code>db_instance_interfaces</code></p></li> <li><p>创建对应的任务</p></li></ol> <h2 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h2> <h3 id="osm-usage"><a href="#osm-usage" class="header-anchor">#</a> OSM Usage</h3> <p>这个<a href="https://osm.etsi.org/docs/user-guide/05-osm-usage.html" target="_blank" rel="noopener noreferrer">页面<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>介绍了创建/管理网络服务的一些场景，可以帮助我们理解<code>cloud-config</code>，<code>instantiation-parameter</code>的实际使用。</p> <h3 id="vnf-onboarding-guide-day-0"><a href="#vnf-onboarding-guide-day-0" class="header-anchor">#</a> VNF Onboarding guide (day-0)</h3> <p><a href="https://osm.etsi.org/docs/vnf-onboarding-guidelines/02-day0.html" target="_blank" rel="noopener noreferrer">VNF OnBoarding Day-0<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>介绍了如何创建/修改/测试vnfd package</p> <p>Remember the objectives of this phase(day-0):</p> <blockquote><ul><li><p>Instantiating the VNF with all the required VDUs, images, initial (unconfigured) state and NFVI requirements.</p></li> <li><p>Making the VNF manageable from OSM (OSM should have SSH access to the management interfaces, for example)</p></li></ul></blockquote> <h3 id="vnf-onboarding-guide-day-1"><a href="#vnf-onboarding-guide-day-1" class="header-anchor">#</a> VNF Onboarding guide (day-1)</h3> <p><a href="https://osm.etsi.org/docs/vnf-onboarding-guidelines/03-day1.html" target="_blank" rel="noopener noreferrer">VNF OnBoarding Day-1<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>介绍了如何修改vnfd，使得vnf可以在被创建后被自动初始化。</p> <p>OSM中实现这个目标的方式是构建osm proxy charm，然后把它包含在descriptor中。</p> <h3 id="cloud-init"><a href="#cloud-init" class="header-anchor">#</a> Cloud-init</h3> <p>Cloud-init是一个工业标准，它使用一种通用的方式描述配置，https://cloudinit.readthedocs.io/en/latest/。
通过cloud-init，我们可以在day-0完成vnf的初始化。</p> <blockquote><p>Cloud-init is normally used for Day-0 operations like:</p> <ul><li>Setting a default locale</li> <li>Setting an instance hostname</li> <li>Generating instance SSH private keys or defining passwords</li> <li>Adding SSH keys to a user’s .ssh/authorized_keys so they can log in</li> <li>Setting up ephemeral mount points</li> <li>Configuring network devices</li> <li>Adding users and groups</li> <li>Adding files</li></ul></blockquote></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/reference/osm/ro/ns_new_instance.html" class="prev">
        从零创建一个实例过程说明
      </a></span> <span class="next"><a href="/reference/osm/ro/vim_interaction.html">
        同VIM的交互
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.131032e6.js" defer></script><script src="/assets/js/2.f5d61f7a.js" defer></script><script src="/assets/js/23.120810af.js" defer></script>
  </body>
</html>
