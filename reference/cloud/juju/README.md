# Juju

Juju是Ubuntu提供的开源软件，目的是简化云环境下应用的部署和运行管理。

## Why Juju

### Multi-cloud suppor

Juju提供了工具和运行环境，屏蔽不同云环境(`K8S`, `OpentStack`, `Bare metal`, `Amazon`, `Azure`)的差异，使我们可以用一种通用的方式执行应用部署、配置、扩容以及其他相关任务。

### 集群管理

当系统由多个不同应用/微服务/组件构成时，Juju支持我们定义应用之间的依赖关系，并在在不同的运行环境中根据依赖关系建立和维护多个应用实例构成的集群。

### Infrastrure as code

Juju基于`Infrastructure as code (IaC)`的理念实现，通过执行用户定义的代码，自动完成应用的部署和其他操作，

Juju提供的编程模型，支持定义复杂的编排过程。通过Juju，我们可以在多个云环境中重用这些代码，使用统一的方式完成应用的部署、配置等任务。

### 开源

Juju是开源并免费的产品，由于它支持基于K8s完成应用的部署和服务的编排，所以它为K8S环境的用户提供了`OpenShift`之外的另一个选项。

## 核心概念

### Application

在Juju环境中，`Application`指可以被独立部署的软件，比如：redis、apache、hadoop等。但是，Juju中的Applicatiion和我们在其他时候谈论的Application有所不同，比如，juju中的redis应用除了包含可以被部署的redis软件介质外，还包含了其他组件，以支持juju等该软件的自动管理（部署、配置等）。

除了Juju中应用的含义更丰富外，`Application`还有以下特点：

#### 应用可以被部署多个实例

实例被称为`Unit`，不同Unit可能位于不同机器中。

#### 应用有一定智能

Juju中的应用可以根据不同状态，主动从juju应用环境中获取需要的信息或者配置。这个过程不需要人工干预。

#### 应用可被管理

Juju应用维护了运行状态和运行指标供外部查询，还提供了特定的action接口供外部调用。

常见的应用action包括：

##### 配置

在编写charm时，我们可以定义部署或运行时设置的配置参数。这样，当我们在juju上部署应用时，可以设置相应的参数；也可以在应用部署后，修改配置参数。

##### 部署

##### 关联

应用之间的关联关系实际上就是应用之间的依赖关系。通过这种关系，上下游应用可以执行某种通信，通信的内容以及每次通信触发的功能则完全由charm决定。

##### 删除

##### 扩容

##### 升级

### Charm

上面提到的Juju应用的管理以及其他智能特性，并不是原生应用提供的，也不是juju自动生成的，而是由用户通过charm技术，使用代码的方式实现的。

用户按照一定的方式，编写了代码逻辑后，通过juju提供的工具，生成charm，提交到官方或者私有的charm仓库。

部署时，我们指定使用的charm，juju从仓库中下载charm，然后将其中的原生软件部署到云，然后启动一个对应的agent，负责对原生软件的监视和管理。所有的管理请求，实际上是转发到该agent。

### Model

### Relation

## How doest it work

### Architecture

### Controller
